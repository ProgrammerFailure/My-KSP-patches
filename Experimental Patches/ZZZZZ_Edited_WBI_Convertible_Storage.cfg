@PART:HAS[@MODULE[ModuleB9PartSwitch]:HAS[#baseVolume,#baseVolume[>0]],!MODULE[WBIConvertibleStorage]]:FINAL
{
	TEMPSTORAGE3 {} // Prevents an error on MM about % not being allowd on root nodes.
	@TEMPSTORAGE3
	{
		v
		{
			a = #$/MODULE[ModuleB9PartSwitch],1/baseVolume$
			b = #$/MODULE[ModuleB9PartSwitch],1/baseVolume$
		}
		v
		{
			a = #$/MODULE[ModuleB9PartSwitch],2/baseVolume$
			b = #$/MODULE[ModuleB9PartSwitch],2/baseVolume$
		}
		v
		{
			a = #$/MODULE[ModuleB9PartSwitch],3/baseVolume$
			b = #$/MODULE[ModuleB9PartSwitch],3/baseVolume$
		}
		%bigger = 0
	}
}
@PART:HAS[TEMPSTORAGE3:HAS[#v]]:FINAL
{
	@TEMPSTORAGE3:HAS[#v]	 
	{
		@v:HAS[#a[>0]]
		{
			@a -= 1
		}
		@bigger = #$/TEMPSTORAGE3/v/b$
		-v:HAS[#a[0]] {}
	}
	MM_PATCH_LOOP {}
}

@PART:HAS[TEMPSTORAGE3]:FINAL
{
	MODULE[WBIConvertibleStorage]
	{
		enableLogging = True
		showGUI = True
		confirmResourceSwitch = True
		defaultTemplate = LFO
		templateNodes = STORAGE_TEMPLATE
		templateTypes = Storage
		fieldReconfigurable = True
		resourcesToReplace = ALL
		capacityFactor = #$/TEMPSTORAGE3/bigger$
		@capacityFactor /= 1801
		logoPanelTransforms = decalPanel001, decalPanel002, decalPanel003, decalPanel004
		decalsVisible = false
		baseStorage = .001
		maxStorage = 9100
	}
}